<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cronmanagement.dao.CronRunHistoryDAO">
	<select id="getCronLogHistory" resultType="cronmanagement.bean.CronLogBean">
		SELECT id as id,
		cron_id as cronId,
		start_time as startTime,
		end_time as endTime,
		serverId as serverId,
		status as status
		FROM cron_run_history;
	</select>
	
	<insert id="insertCronLogHistory">
		INSERT INTO
		cron_run_history (
		cron_id, start_time, end_time, serverId, status
		)
		VALUES (
		<foreach item="cronLog" index="index" collection="cronLogs"
			open="" close="" separator="),(">
			#{cronLog.cronId}, #{cronLog.startTime}, #{cronLog.endTime}, #{cronLog.serverId}, 'active'
		</foreach>
		)
	</insert>
	
	<update id="updateCronLogHistory">
		update 
		cron_run_history set status='inactive' where cronId in (
		<foreach item="cronLog" index="index" collection="cronLogs"
			open="" close="" separator=",">
			#{cronLog.cronId}
		</foreach>
		)
	</update>
</mapper>